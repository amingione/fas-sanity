---

TASK: Produce authoritative contract decisions for fixing <ISSUE DESCRIPTION>.

--------------------------------------------------

INPUTS (SOURCE OF TRUTH):
1. docs/reports/<issue>-audit.md
2. docs/reports/cross-repo-contract-decisions.md
3. CLAUDE.md

--------------------------------------------------

ROLE:
You are the DECISION AUTHORITY.

Your output is AUTHORITATIVE and BINDING.
It will be consumed directly by Codex.
Codex will implement ONLY what is explicitly approved here.
Anything not approved here MUST NOT be implemented.

--------------------------------------------------

SCOPE:
- Repo: <REPO NAME> ONLY
- Area affected:
  - <LOGIC / SCHEMA / QUERY / DESK â€” explicitly list>
  
Anything outside this scope is OUT OF BOUNDS.

--------------------------------------------------

OPTIONAL BACKEND CONTRACT ALIGNMENT (USE WHEN APPLICABLE)

If this issue involves an existing backend integration
(e.g. EasyPost, Stripe, Auth, etc.):

You MUST:
- Identify the authoritative backend function or contract
- Define the exact input fields it expects
- Define which inputs are:
  - Derived
  - User-editable
  - System-controlled
- Define the exact response fields that may be consumed or persisted

You MUST NOT:
- Invent new parameters
- Redesign the backend interface
- Assume defaults not present in the audit
- Delegate contract decisions to Codex

--------------------------------------------------

YOU MUST USE THE FOLLOWING FORMAT EXACTLY

--------------------------------------------------
EXECUTIVE SUMMARY
(One short paragraph explaining the root cause and why this change is required)

DECISIONS

SCHEMA CHANGES
- APPROVED or REJECTED
- If approved:
  - Field name
  - Type
  - Authority (system / user / read-only)
  - Default behavior
- If rejected:
  - Explicit statement that schema remains unchanged

LOGIC CHANGES
- APPROVED or REJECTED
- If approved:
  - Exact logic paths that must change
  - Conditions under which the logic must execute
  - Explicit behavior boundaries
- No pseudocode

QUERY / DESK STRUCTURE CHANGES
- APPROVED or REJECTED
- If approved:
  - Exact query behavior changes
  - Explicit inclusion / exclusion rules

DATA INTEGRITY RULES
- Explicit invariants that must hold after enforcement

FORBIDDEN CHANGES
- Explicit list of what Codex is NOT allowed to touch

ROLLBACK SAFETY
- Why this change cannot affect unrelated behavior
--------------------------------------------------

--------------------------------------------------

CRITICAL RULES:
- Do NOT implement anything
- Do NOT write code
- Do NOT speculate beyond the audit
- Do NOT infer missing intent
- Do NOT redesign existing systems
- If information is missing or unclear, state it explicitly and STOP

--------------------------------------------------

OUTPUT REQUIREMENT:
Save the document as:
docs/reports/<issue>-contract-decisions.md

--------------------------------------------------

POST-CONTRACT CODEX ENFORCEMENT PROMPT (REQUIRED)

After producing the contract decisions document above, you MUST also generate
a Codex enforcement prompt derived from those decisions.

You MUST:

- Create a new file at:
  docs/prompts/codex-enf/<issue>-enforcement.txt

- Use the template located at:
  docs/ai-governance/templates/codex-enforcement.template.txt

- Populate that template so it strictly enforces ONLY the decisions defined in:
  docs/reports/<issue>-contract-decisions.md

The generated Codex enforcement prompt MUST:

- Be non-interactive and deterministic
- Explicitly list:
  - Files allowed to change
  - Files forbidden to change
  - Enforcement constraints
  - Stop conditions if scope is exceeded
- Prohibit inference, redesign, refactoring, optimization, or scope expansion
- Instruct Codex to STOP if an unapproved change is required

You MUST NOT:

- Implement any code
- Run Codex
- Modify files outside the decision document
- Generate a generic or reusable enforcement prompt

Failure to generate this enforcement prompt file is considered an INCOMPLETE TASK.